/*
 * File: app/store/mainpage_shdatalist.js
 *
 * This file was generated by Sencha Architect version 3.5.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('liftnet.store.mainpage_shdatalist', {
    extend: 'Ext.data.Store',

    requires: [
        'Ext.data.Field'
    ],

    config: {
        storeId: 'mainpage_shdatalist',
        fields: [
            {
                name: 'type',
                type: 'string'
            },
            {
                name: 'title',
                type: 'string'
            },
            {
                name: 'key1',
                type: 'string'
            },
            {
                name: 'datetime',
                type: 'string'
            },
            {
                name: 'status',
                type: 'string'
            },
            {
                name: 'taskid',
                type: 'string'
            },
            {
                name: 'titleIcon',
                type: 'string'
            },
            {
                name: 'statusColor',
                type: 'string'
            }
        ]
    },

    loadDat: function(onSuccess, onFailure, parm) {
        var me = this;

        if(global.isWorklight()) {
            // adapter取数
            var url = '/adapters/mainpage/api/1.0/shdatalist';
            var userid = global.getUserId();
            var adapterParm = {userid: userid, keyword: ''};

            callPostAdapter(
                url, adapterParm,
                function(ret) {
                    var d = me.decoDat(ret.data);
                    me.setData(d);
                    onSuccess(d.length);
                },
                onFailure);
        } else {
            var d = this.decoDat([
                {
                    type:'0',
                    title: '工程报价联络书审核',
                    titleIcon: '<i class="ln ln-report-hotline"></i>',
                    key1: '越秀城市广场',
                    datetime: '2015-12-25 13:31',
                    status: '待处理',
                    taskid: '0-123456',
                    statusColor: ''
                },
                {
                    type:'1',
                    title: '商务审批',
                    titleIcon: '<i class="ln ln-presale"></i>',
                    key1: '越秀城市广场',
                    datetime: '2015-12-25 09:45',
                    status: '待处理',
                    taskid: '1-123456',
                    statusColor: ''
                },
                {
                    type:'3',
                    title: '来款审核',
                    titleIcon: '<i class="ln ln-dollar"></i>',
                    key1: '广州一洲物业管理有限公司',
                    datetime: '2015-04-13 14:30',
                    status: '待处理',
                    taskid: '3-123456',
                    statusColor: ''
                },
                {
                    type:'5',
                    title: '开票审核',
                    titleIcon: '<i class="ln ln-dollar"></i>',
                    key1: '广州三和物业管理有限公司',
                    datetime: '2015-03-01 15:25',
                    status: '待处理',
                    taskid: '5-123456',
                    statusColor: ''
                },
                {
                    type:'6',
                    title: '保养合同审核',
                    titleIcon: '<i class="ln ln-contract"></i>',
                    key1: '广州一洲物业管理有限公司',
                    datetime: '2015-12-01 10:05',
                    status: '待处理',
                    taskid: '6-123456',
                    statusColor: ''
                },
                {
                    type:'7',
                    title: '维修合同审批',
                    titleIcon: '<i class="ln ln-contract"></i>',
                    key1: '广州市粤商投资有限公司',
                    datetime: '2015-09-23 12:31',
                    status: '待处理',
                    taskid: '7-123456',
                    statusColor: ''
                },
                {
                    type:'8',
                    title: '保养作业签收',
                    titleIcon: '<i class="ln ln-flashlight"></i>',
                    key1: '荔湾区大冶有色大厦',
                    datetime: '2015-09-23 12:31',
                    status: '待处理',
                    taskid: '8-123456',
                    statusColor: ''
                },
                {
                    type:'9',
                    title: '保养计划审核',
                    titleIcon: '<i class="ln ln-report-maintain"></i>',
                    key1: '广州市西城都荟管理公司',
                    datetime: '2015-09-23 12:31',
                    status: '待处理',
                    taskid: '9-123456',
                    statusColor: ''
                },
                {
                    type:'9',
                    title: '保养计划审核',
                    titleIcon: '<i class="ln ln-report-maintain"></i>',
                    key1: '广州市西城都荟管理公司',
                    datetime: '2015-09-23 12:31',
                    status: '已完成',
                    taskid: '9-654321',
                    statusColor: ''
                },
            ]);
                this.setData(d);
                onSuccess(d.length);
                }
    },

    filteDat: function(parm) {
        this.clearFilter();

        if(parm!=='') {
            this.filterBy(function(item) {
                var s = item.get("title") + ' ' + item.get("key1") + ' ' + item.get("datetime");
                return (s.toUpperCase().indexOf(parm.toUpperCase())>=0);
            });
        }
    },

    decoDat: function(data) {
        if(!data) return([]);

        var icon = [];
        icon['0'] = '<i class="ln ln-report-hotline"></i>';
        icon['1'] = '<i class="ln ln-presale"></i>';
        icon['2'] = '<i class="fa fa-question-circle"></i>';
        icon['3'] = '<i class="ln ln-dollar"></i>';
        icon['4'] = '<i class="fa fa-question-circle"></i>';
        icon['5'] = '<i class="ln ln-dollar"></i>';
        icon['6'] = '<i class="ln ln-contract"></i>';
        icon['7'] = '<i class="ln ln-contract"></i>';
        icon['8'] = '<i class="ln ln-flashlight"></i>';
        icon['9'] = '<i class="ln ln-report-maintain"></i>';

        for(var i=0;i<data.length; i++) {

            if(data[i].type>='0' && data[i].type<='9') {
                data[i].titleIcon = icon[data[i].type];
            }

            switch(data[i].status) {
                case '待审核':
                    data[i].statusColor = 'liftnet-fontColor-orange';
                    break;

                case '已完成':
                    data[i].statusColor = 'liftnet-fontColor-blue';
                    break;
            }
        }

        return(data);
    }

});