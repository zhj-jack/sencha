/*
 * File: app/controller/ComMapController.js
 *
 * This file was generated by Sencha Architect version 3.5.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('liftnet.controller.ComMapController', {
    extend: 'Ext.app.Controller',

    config: {
        control: {
            "panel#ComMap": {
                show: 'onComMapShow',
                destroy: 'onComMapDestroy'
            },
            "button#ComMap_BtnReturn": {
                tap: 'onComMap_BtnReturnTap'
            }
        }
    },

    onComMapShow: function(component, eOpts) {
        view = component;

        var lng = view.initialConfig.parm.lng;
        var lat = view.initialConfig.parm.lat;
        var fn = view.initialConfig.parm.fnClick;

        if(!lng || lng===''){
            lng = map.getLocation().lng;
        }
        if(!lat|| lat===''){
            lat = map.getLocation().lat;
        }

        //初始化地图
        var getlnglat = function(e){
            var map = new BMap.Map("ComMap_MapPanel");

            console.log(e.point.lng+'____+__'+e.point.lat);

            var r2 = e.point.lng+','+e.point.lat;
            fn(r2);

            viewUtil.goLast();
        };

        map.create2('ComMap_MapPanel',{lng:lng,lat:lat,zoom:19,fc:getlnglat});
    },

    onComMapDestroy: function(eOpts) {
        map.destroyById('ComMap_MapPanel');
    },

    onComMap_BtnReturnTap: function(button, e, eOpts) {
        viewUtil.goLast();
    }

});